{%- if section.settings.layout == 'box_width' -%}
  {%- assign container = 'container' -%}
{%- else -%}
  {%- assign container = 'full-width' -%}
{%- endif -%}

{% assign padding = section.settings.padding | split: '|' %}
{% assign margin = section.settings.margin | split: '|' %}

{%- style -%}
  #shopify-section-{{ section.id }} .reworked_faq {
    {% if padding[0] != blank %}padding: {{ padding[0] }};{% endif %}
    {% if margin[0] != blank %}margin: {{ margin[0] }};{% endif %}
    background: {{ section.settings.bg_color }};
  }

  @media (max-width: 1199px) {
    #shopify-section-{{ section.id }} .reworked_faq {
      {% if padding[1] != blank %}padding: {{ padding[1] }};{% endif %}
      {% if margin[1] != blank %}margin: {{ margin[1] }};{% endif %}
    }
  }

  @media (max-width: 991px) {
    #shopify-section-{{ section.id }} .reworked_faq {
      {% if padding[2] != blank %}padding: {{ padding[2] }};{% endif %}
      {% if margin[2] != blank %}margin: {{ margin[2] }};{% endif %}
    }
  }

  @media (max-width: 767px) {
    #shopify-section-{{ section.id }} .reworked_faq {
      {% if padding[3] != blank %}padding: {{ padding[3] }};{% endif %}
      {% if margin[3] != blank %}margin: {{ margin[3] }};{% endif %}
    }
  }
{%- endstyle -%}

{% assign faq_items = product.metafields.custom.accordion_with_image.value %}
{% assign first_faq = faq_items.first %}
{% assign media_url = first_faq.image | file_url %}
{% assign is_mp4 = false %}
{% assign is_webm = false %}
{% if media_url contains '.mp4' %}
  {% assign is_mp4 = true %}
{% endif %}
{% if media_url contains '.webm' %}
  {% assign is_webm = true %}
{% endif %}
{% assign is_video = false %}
{% if is_mp4 or is_webm %}
  {% assign is_video = true %}
{% endif %}

<section class="ludic-section reworked_faq ludic-section-{{ section.id }}">
  <div class="{{ container }}">

    <div class="reworked_faq_inner">
      <div class="reworked_faq_right">
        <div class="reworked_faq_img">
          <img src="https://cdn.shopify.com/s/files/1/0823/6787/3328/files/ww.png?v=1762854893">
        </div>
      </div>

      <div class="reworked_faq_left">
        <div id="faq_questions_list">
            <div class="meta_question active" data-index="0">
              <div class="faq_main">
                <div class="meta_question_text">Description</div>
                <div class="meta_question_icon">
                  <span class="meta_question_icon_pluse">
                    +
                  </span>
                  <span class="meta_question_icon_minus">
                    -
                  </span>
                </div>
              </div>
              <div class="meta_answer">
               The ultra functionality that starts at the master storage with an 'intestine' organizer, and ends at a sturdy, reliable base. In between, the dimension unfolds - detachable dopp kit, expandable open pocket, and the side sleeve where yoga mats or a luggage handle can slip into.
              </div>
            </div>
            <div class="meta_question" data-index="1">
              <div class="faq_main">
                <div class="meta_question_text">Why reworked</div>
                <div class="meta_question_icon">
                  <span class="meta_question_icon_pluse">
                    +
                  </span>
                  <span class="meta_question_icon_minus">
                    -
                  </span>
                </div>
              </div>
              <div class="meta_answer">
                The ultra functionality that starts at the master storage with an 'intestine' organizer, and ends at a sturdy, reliable base. In between, the dimension unfolds - detachable dopp kit, expandable open pocket, and the side sleeve where yoga mats or a luggage handle can slip into.
              </div>
            </div>
            <div class="meta_question" data-index="2">
              <div class="faq_main">
                <div class="meta_question_text">What it fits</div>
                <div class="meta_question_icon">
                  <span class="meta_question_icon_pluse">
                    +
                  </span>
                  <span class="meta_question_icon_minus">
                    -
                  </span>
                </div>
              </div>
              <div class="meta_answer">
                The ultra functionality that starts at the master storage with an 'intestine' organizer, and ends at a sturdy, reliable base. In between, the dimension unfolds - detachable dopp kit, expandable open pocket, and the side sleeve where yoga mats or a luggage handle can slip into.
                <div class="fits_blocks">
                    <div class="fits_box">
                        <div class="fits_info">
                            <h5>Dopp Kit</h5>
                            <p>Designed to keep smaller items like socks and t-shirts organized in your travel bag.</p>
                        </div>
                        <img src="https://cdn.shopify.com/s/files/1/0823/6787/3328/files/faqs_asset.png?v=1762856306">
                    </div>
                    <div class="fits_box">
                        <div class="fits_info">
                            <h5>Dopp Kit</h5>
                            <p>Designed to keep smaller items like socks and t-shirts organized in your travel bag.</p>
                        </div>
                        <img src="https://cdn.shopify.com/s/files/1/0823/6787/3328/files/faqs_asset.png?v=1762856306">
                    </div>
                    <div class="fits_box">
                        <div class="fits_info">
                            <h5>Dopp Kit</h5>
                            <p>Designed to keep smaller items like socks and t-shirts organized in your travel bag.</p>
                        </div>
                        <img src="https://cdn.shopify.com/s/files/1/0823/6787/3328/files/faqs_asset.png?v=1762856306">
                    </div>
                    <div class="fits_box">
                        <div class="fits_info">
                            <h5>Dopp Kit</h5>
                            <p>Designed to keep smaller items like socks and t-shirts organized in your travel bag.</p>
                        </div>
                        <img src="https://cdn.shopify.com/s/files/1/0823/6787/3328/files/faqs_asset.png?v=1762856306">
                    </div>
                </div>
              </div>
            </div>
            <div class="meta_question" data-index="3">
              <div class="faq_main">
                <div class="meta_question_text">Build and design</div>
                <div class="meta_question_icon">
                  <span class="meta_question_icon_pluse">
                    +
                  </span>
                  <span class="meta_question_icon_minus">
                    -
                  </span>
                </div>
              </div>
              <div class="meta_answer">
                The ultra functionality that starts at the master storage with an 'intestine' organizer, and ends at a sturdy, reliable base. In between, the dimension unfolds - detachable dopp kit, expandable open pocket, and the side sleeve where yoga mats or a luggage handle can slip into.
              </div>
            </div>
            <div class="meta_question" data-index="4">
              <div class="faq_main">
                <div class="meta_question_text">Material & Composition</div>
                <div class="meta_question_icon">
                  <span class="meta_question_icon_pluse">
                    +
                  </span>
                  <span class="meta_question_icon_minus">
                    -
                  </span>
                </div>
              </div>
              <div class="meta_answer">
                The ultra functionality that starts at the master storage with an 'intestine' organizer, and ends at a sturdy, reliable base. In between, the dimension unfolds - detachable dopp kit, expandable open pocket, and the side sleeve where yoga mats or a luggage handle can slip into.
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</section>


{% style %}
  .reworked_faq .meta_answer {
    height: 0;
    overflow: hidden;
    transition: height 0.4s ease;
  }
  .reworked_faq .meta_question:not(.active) .meta_answer {
    height: 0;
    overflow: hidden;
  }
  .reworked_faq .meta_question.active .meta_answer {
    height: auto;
  }
{% endstyle %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const faqItems = document.querySelectorAll('.meta_question');

    faqItems.forEach((item) => {
      item.addEventListener('click', () => {
        // Collapse all items except the clicked one
        faqItems.forEach((el) => {
          if (el !== item) {
            el.classList.remove('active');
            const answer = el.querySelector('.meta_answer');
            answer.style.height = '0px';
          }
        });

        // Toggle clicked item
        const isActive = item.classList.contains('active');
        const answer = item.querySelector('.meta_answer');

        if (isActive) {
          item.classList.remove('active');
          answer.style.height = '0px';
        } else {
          item.classList.add('active');
          answer.style.height = answer.scrollHeight + 'px';
          answer.addEventListener('transitionend', function handler() {
            answer.style.height = 'auto';
            answer.removeEventListener('transitionend', handler);
          });
        }
      });
    });

    // âœ… Open first two by default
    const defaultOpenIndexes = [0, 1];
    defaultOpenIndexes.forEach((index) => {
      const item = document.querySelector(`.meta_question[data-index="${index}"]`);
      if (item) {
        item.classList.add('active');
        const answer = item.querySelector('.meta_answer');
        answer.style.height = 'auto';
      }
    });
  });
</script>


{% schema %}
{
  "name": "Reworked FAQ",
  "tag": "section",
  "settings": [
    {
      "type": "select",
      "id": "layout",
      "options": [
        { "value": "full-width", "label": "Full Width" },
        { "value": "box_width", "label": "Box Width" }
      ],
      "label": "Layout",
      "default": "box_width"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "padding",
      "label": "Padding",
      "default": "80px 0px 80px 0px|60px 0px 60px 0px|40px 0px 40px 0px|20px 0px 20px 0px",
      "info": "Format: desktop | 1200px | 991px | 767px"
    },
    {
      "type": "text",
      "id": "margin",
      "label": "Margin",
      "default": "0px 0px 0px 0px| | |36px 0px",
      "info": "Format: desktop | 1200px | 991px | 767px"
    }
  ],
  "blocks": [],
  "presets": [
    {
      "name": "Reworked FAQ"
    }
  ]
}
{% endschema %}
